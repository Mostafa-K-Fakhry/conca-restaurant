generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("USER")
  orders    Order[]
  createdAt DateTime @default(now())
}

model Category {
  id        String    @id @default(cuid())
  nameAr    String
  nameEn    String?
  image     String?
  sortOrder Int       @default(0)
  products  Product[]
  createdAt DateTime  @default(now())
}

model Product {
  id          String           @id @default(cuid())
  categoryId  String
  category    Category         @relation(fields: [categoryId], references: [id])
  nameAr      String
  nameEn      String?
  description String?
  image       String?
  isAvailable Boolean          @default(true)
  variants    ProductVariant[]
  createdAt   DateTime         @default(now())
}

model ProductVariant {
  id         String      @id @default(cuid())
  productId  String
  product    Product     @relation(fields: [productId], references: [id], onDelete: Cascade)
  nameAr     String
  price      Decimal
  orderItems OrderItem[]
}

model Order {
  id            Int         @id @default(autoincrement())
  userId        String?
  user          User?       @relation(fields: [userId], references: [id])
  customerName  String
  customerPhone String
  address       String?
  orderType     String
  status        String      @default("PENDING")
  paymentMethod String      @default("CASH")
  totalAmount   Decimal
  items         OrderItem[]
  createdAt     DateTime    @default(now())
}

model OrderItem {
  id          String          @id @default(cuid())
  orderId     Int
  order       Order           @relation(fields: [orderId], references: [id])
  productName String
  variantName String?
  quantity    Int
  price       Decimal
  totalPrice  Decimal
  notes       String?
  variantId   String?
  variant     ProductVariant? @relation(fields: [variantId], references: [id])
}